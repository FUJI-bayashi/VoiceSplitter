# VOICE SPLITTER

## 概要

VoiceSplitterはWindows向けのコンソールアプリケーションで、wav形式の音声ファイルを解析して以下の二つの機能を提供します。

1. 音声の波形画像を生成します。
2. 特定の音量スパイク（音量が大きくなったところ）に基づいて、wavファイルを複数ファイルに分割します。

## 目的≒用途

LOVEdeLICが1997年に開発したプレイステーション用ゲーム『moon』に見られる特殊なボイスシステムを再現するための補助的ツールとして開発しました。
再現のためには、連続した音声ファイルを文節や単語単位で分割して保存する必要があります。このソフトウェアはそのような分割作業を自動化するためのものです。

## 依存関係

- .NET 7.0 (Windows)
- NAudio 2.2.1
- System.Drawing.Common 7.0.0
- System.Runtime.InteropServices 4.3.0

### プラットフォーム

- Windows専用

## 設定

設定は`config.txt`ファイルで管理されます。以下のオプションがあります。

- `ImageHeight`: 生成される波形画像の高さ（デフォルトは500）。
- `ImageWidthMax`: 生成される波形画像の最大幅（デフォルトは1920）。
- `OutputImageName`: 生成される波形画像の出力名（デフォルトは**`_waveform.png`**）。
- `VolumeThreshold`: 音量スパイクを検出するしきい値（デフォルトは0.1）。
- `SpikeDetectionMultiplier`: 音量スパイクの検出倍数（デフォルトは3）。
- `QueueNum`: 音量平均の計算に使用するサンプル数（デフォルトは10）。
- `CoolDownSamples`: 音量スパイク後の冷却サンプル数（デフォルトは20）。

## 使用方法

1. とりあえず`VoiceSplitter.exe`を実行してください。エラーになりますが、必要なフォルダと設定ファイルが生成されます。
1. `Input`フォルダに解析したいwav形式の音声ファイルを配置してください。ファイルは複数あっても構いません。
1. `VoiceSplitter.exe`を実行してください。
1. 処理が完了すると、`Output`フォルダ内に分割されたwavファイルと、分割した位置を明示する波形画像が生成されます。
1. 好みの結果とならない場合は後述の方法で`config.txt`ファイルの値を編集してください。

## `config.txt` ファイルの編集ガイド

### `ImageHeight`

- **説明**: **重要ではありません。** 出力される波形画像の高さをピクセル単位で設定します。
- **形式**: 整数（例: `500`）

### `ImageWidthMax`

- **説明**: **重要ではありません。** 出力される波形画像の最大幅をピクセル単位で設定します。
- **形式**: 整数（例: `1920`）

### `OutputImageName`

- **説明**: **重要ではありません。** 出力される波形画像のファイル名を設定します。
- **形式**: 文字列（例: `_waveform.png`）

### `VolumeThreshold`

- **説明**: 音量のしきい値。この値より小さい音は無音とみなされ、そのサンプルはスパイク判定される可能性があります。
- **どうするとどうなる**: 小さくすると分割量が多くなり、大きくすると分割量が少なくなります。
- **形式**: 浮動小数点数（例: `0.1`）

### `SpikeDetectionMultiplier`

- **説明**: スパイク検出の倍数。後述の平均音量値にこの値を掛けたものがスパイクのしきい値になります。
- **どうするとどうなる**: 小さくすると分割量が多くなり、大きくすると分割量が少なくなります。
- **形式**: 浮動小数点数（例: `3`）

### `QueueNum`

- **説明**: 各サンプルを基点にして、この数の前後のサンプル音量から平均値を算出します。
- **どうするとどうなる**: 小さくすると分割量が多くなり、大きくすると分割量が少なくなります。
- **形式**: 整数（例: `10`）

### `CoolDownSamples`

- **説明**: スパイク後のクールダウン期間。スパイク判定されたサンプルからこの数が経過するまではスパイク判定を行いません。
- **どうするとどうなる**: 小さくすると分割量が多くなり、大きくすると分割量が少なくなります。
- **形式**: 整数（例: `20`）

## 作成者

- ***KITTYPOOL*** [BLOG](https://kitty-pool.com) [YouTube](https://www.youtube.com/channel/UCWTRB1h8GA-AFGExP1pf_7w)

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。
